---
description: 'バックエンド: FastAPI規約 (ルーティング、スキーマ、エラー、認証境界)'
globs: ['backend/app/**/*', 'backend/tests/**/*']
alwaysApply: false
---

# FastAPI 規約

## API境界

- ルーターは `backend/app/api/http/*` (または既存の規約) に配置。
- スキーマ/DTO: 境界 (API/App) に置き、インフラモデルのリークを避ける。

## エラー処理

- 明示的なエラーマッピングを優先:
  - ドメイン/アプリケーションエラー → HTTPステータス + 構造化ペイロード
- 生の例外やスタックトレースを返さない。

## 認証境界

- 認証/セッション処理は既存のアプローチと一貫性を保つ。
- 認証エンドポイントを変更する場合は、OpenAPI + 統合テストも更新。
